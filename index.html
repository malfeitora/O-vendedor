<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>VAGABOND - Loja do DUQUE</title>
    <style>
        body {
            background-color: #0a0a0a;
            color: #f5f5f5;
            font-family: 'Georgia', serif;
            text-align: center;
            padding: 50px;
        }
        .store {
            margin-top: 30px;
        }
        .item {
            display: inline-block;
            margin: 10px;
        }
        .item img {
            width: 100px;
            height: 100px;
            border: 2px solid gold;
            border-radius: 10px;
        }
        .loading {
            font-size: 1.5em;
            color: goldenrod;
            margin-top: 20px;
        }
        .horario {
            font-size: 1.2em;
            color: #aaffcc;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>LOJA DO DUQUE</h1>
    <div class="horario" id="horario"></div>
    <div class="store" id="store"></div>
    <div class="loading" id="loading"></div>

    <script>
        const items = [
            "academy_glintstone_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "albinauric_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "antspur_rapier_thrusting_sword_weapon_elden_ring_wiki_guide_200px.webp",
            "astrologers_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "azurs-glintstone-staff-weapon-elden-ring-wiki-guide-200.webp",
            "azurs_glintstone_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "beast_claw_beast_claws_elden_ring_shadow_of_the_erdtree_dlc_wiki_guide_200px.webp",
            "butchering_knife_greataxe_weapon_elden_ring_wiki_guide_200px.webp",
            "carian_glintblade_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "carian_glintstone_staff_glintstone_staffs-elden-ring-wiki-guide-200.webp",
            "carian_regal_scepter_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "crystal_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp",
            "curseblades_cirque_elden_ring_shadow_of_the_erdtree_dlc_wiki_guide_200px.webp",
            "deadly_poison_perfume_bottle_perfume_bottles_elden_ring_shadow_of_the_erdtree_dlc_wiki_guide_75px.webp",
            "death_knights_longhaft_axe_elden_ring_shadow_of_the_erdtree_dlc_wiki_guide_75px.webp",
            "demi-human_queens_staff_glintstonestaff_weapon_elden_ring_wiki_guide_200px.webp"
        ];

        const frasesDuque = [
            "O DUQUE está negociando seus itens, aguarde.",
            "O DUQUE partiu rumo ao Reino da Névoa Eterna.",
            "O DUQUE está indo para as Terras Proibidas.",
            "O DUQUE foi visto nas margens da Árvore-Mãe.",
            "O DUQUE está dormindo sob as cinzas de um antigo dragão."
        ];

        function formatarHora(h, m) {
            return h.toString().padStart(2, '0') + ":" + m.toString().padStart(2, '0');
        }

        function escolherItensAleatorios(quantidade) {
            let escolhidos = [];
            let usados = new Set();
            while (escolhidos.length < quantidade) {
                let i = Math.floor(Math.random() * items.length);
                if (!usados.has(i)) {
                    escolhidos.push(items[i]);
                    usados.add(i);
                }
            }
            return escolhidos;
        }

        function mostrarLoja(horaInicio, minutoInicio, horaFim, minutoFim) {
            const storeDiv = document.getElementById("store");
            const loadingDiv = document.getElementById("loading");
            const horarioDiv = document.getElementById("horario");

            storeDiv.innerHTML = "";
            loadingDiv.innerHTML = "";
            horarioDiv.innerHTML = `LOJA ABERTA entre <strong>${formatarHora(horaInicio, minutoInicio)}</strong> e <strong>${formatarHora(horaFim, minutoFim)}</strong>`;

            const itensHoje = escolherItensAleatorios(5);
            itensHoje.forEach(item => {
                const itemDiv = document.createElement("div");
                itemDiv.classList.add("item");
                itemDiv.innerHTML = `<img src="imagens/${item}" alt="${item}">`;
                storeDiv.appendChild(itemDiv);
            });
        }

        function mostrarFechada() {
            const storeDiv = document.getElementById("store");
            const loadingDiv = document.getElementById("loading");
            const horarioDiv = document.getElementById("horario");

            storeDiv.innerHTML = "";
            horarioDiv.innerHTML = "";
            const frase = frasesDuque[Math.floor(Math.random() * frasesDuque.length)];
            loadingDiv.innerHTML = frase;
        }

        // Definir horário aleatório local para abrir
        const agora = new Date();
        const horaAgora = agora.getHours();
        const minutoAgora = agora.getMinutes();

        let horarioAbertura = localStorage.getItem("duque_abre_em");

        if (!horarioAbertura) {
            const horaAleatoria = 8 + Math.floor(Math.random() * 14); // 8h até 21h
            const minutoAleatorio = Math.floor(Math.random() * 60);
            horarioAbertura = `${horaAleatoria}:${minutoAleatorio}`;
            localStorage.setItem("duque_abre_em", horarioAbertura);
        }

        const [horaAbertura, minutoAbertura] = horarioAbertura.split(":").map(Number);
        const minutosAbertura = horaAbertura * 60 + minutoAbertura;
        const minutosAgora = horaAgora * 60 + minutoAgora;
        const duracaoMinutos = 23;
        const minutosFechamento = minutosAbertura + duracaoMinutos;

        const horaFechamento = Math.floor(minutosFechamento / 60);
        const minutoFechamento = minutosFechamento % 60;

        if (minutosAgora >= minutosAbertura && minutosAgora <= minutosFechamento) {
            mostrarLoja(horaAbertura, minutoAbertura, horaFechamento, minutoFechamento);
        } else {
            mostrarFechada();
        }
    </script>
</body>
</html>
